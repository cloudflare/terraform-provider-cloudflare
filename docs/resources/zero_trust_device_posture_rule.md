---
page_title: "cloudflare_zero_trust_device_posture_rule Resource - Cloudflare"
subcategory: ""
description: |-
  
---

# cloudflare_zero_trust_device_posture_rule (Resource)



## Example Usage

```terraform
resource "cloudflare_zero_trust_device_posture_rule" "example_zero_trust_device_posture_rule" {
  account_id = "699d98642c564d2e855e9661899b7252"
  name = "Admin Serial Numbers"
  type = "file"
  description = "The rule for admin serial numbers"
  expiration = "1h"
  input = {
    operating_system = "linux"
    path = "/bin/cat"
    exists = true
    sha256 = "https://api.us-2.crowdstrike.com"
    thumbprint = "0aabab210bdb998e9cf45da2c9ce352977ab531c681b74cf1e487be1bbe9fe6e"
  }
  match = [{
    platform = "windows"
  }]
  schedule = "1h"
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `account_id` (String)
- `name` (String) The name of the device posture rule.
- `type` (String) The type of device posture rule.
Available values: "file", "application", "tanium", "gateway", "warp", "disk_encryption", "sentinelone", "carbonblack", "firewall", "os_version", "domain_joined", "client_certificate", "client_certificate_v2", "unique_client_id", "kolide", "tanium_s2s", "crowdstrike_s2s", "intune", "workspace_one", "sentinelone_s2s", "custom_s2s".

### Optional

- `description` (String) The description of the device posture rule.
- `expiration` (String) Sets the expiration time for a posture check result. If empty, the result remains valid until it is overwritten by new data from the WARP client.
- `input` (Attributes) The value to be checked against. (see [below for nested schema](#nestedatt--input))
- `match` (Attributes List) The conditions that the client must match to run the rule. (see [below for nested schema](#nestedatt--match))
- `schedule` (String) Polling frequency for the WARP client posture check. Default: `5m` (poll every five minutes). Minimum: `1m`.

### Read-Only

- `id` (String) API UUID.

<a id="nestedatt--input"></a>
### Nested Schema for `input`

Optional:

- `active_threats` (Number) The Number of active threats.
- `certificate_id` (String) UUID of Cloudflare managed certificate.
- `check_disks` (List of String) List of volume names to be checked for encryption.
- `check_private_key` (Boolean) Confirm the certificate was not imported from another device. We recommend keeping this enabled unless the certificate was deployed without a private key.
- `cn` (String) Common Name that is protected by the certificate
- `compliance_status` (String) Compliance Status
Available values: "compliant", "noncompliant", "unknown".
- `connection_id` (String) Posture Integration ID.
- `count_operator` (String) Count Operator
Available values: "<", "<=", ">", ">=", "==".
- `domain` (String) Domain
- `eid_last_seen` (String) For more details on eid last seen, refer to the Tanium documentation.
- `enabled` (Boolean) Enabled
- `exists` (Boolean) Whether or not file exists
- `extended_key_usage` (List of String) List of values indicating purposes for which the certificate public key can be used
- `id` (String) List ID.
- `infected` (Boolean) Whether device is infected.
- `is_active` (Boolean) Whether device is active.
- `issue_count` (String) The Number of Issues.
- `last_seen` (String) For more details on last seen, please refer to the Crowdstrike documentation.
- `locations` (Attributes) (see [below for nested schema](#nestedatt--input--locations))
- `network_status` (String) Network status of device.
Available values: "connected", "disconnected", "disconnecting", "connecting".
- `operating_system` (String) Operating system
Available values: "windows", "linux", "mac".
- `operational_state` (String) Agent operational state.
Available values: "na", "partially_disabled", "auto_fully_disabled", "fully_disabled", "auto_partially_disabled", "disabled_error", "db_corruption".
- `operator` (String) operator
Available values: "<", "<=", ">", ">=", "==".
- `os` (String) Os Version
- `os_distro_name` (String) Operating System Distribution Name (linux only)
- `os_distro_revision` (String) Version of OS Distribution (linux only)
- `os_version_extra` (String) Additional version data. For Mac or iOS, the Product Version Extra. For Linux, the kernel release version. (Mac, iOS, and Linux only)
- `overall` (String) overall
- `path` (String) File path.
- `require_all` (Boolean) Whether to check all disks for encryption.
- `risk_level` (String) For more details on risk level, refer to the Tanium documentation.
Available values: "low", "medium", "high", "critical".
- `score` (Number) A value between 0-100 assigned to devices set by the 3rd party posture provider.
- `score_operator` (String) Score Operator
Available values: "<", "<=", ">", ">=", "==".
- `sensor_config` (String) SensorConfig
- `sha256` (String) SHA-256.
- `state` (String) For more details on state, please refer to the Crowdstrike documentation.
Available values: "online", "offline", "unknown".
- `thumbprint` (String) Signing certificate thumbprint.
- `total_score` (Number) For more details on total score, refer to the Tanium documentation.
- `version` (String) Version of OS
- `version_operator` (String) Version Operator
Available values: "<", "<=", ">", ">=", "==".

<a id="nestedatt--input--locations"></a>
### Nested Schema for `input.locations`

Optional:

- `paths` (List of String) List of paths to check for client certificate on linux.
- `trust_stores` (List of String) List of trust stores to check for client certificate.



<a id="nestedatt--match"></a>
### Nested Schema for `match`

Optional:

- `platform` (String) Available values: "windows", "mac", "linux", "android", "ios", "chromeos".

## Import

Import is supported using the following syntax:

```shell
$ terraform import cloudflare_zero_trust_device_posture_rule.example '<account_id>/<rule_id>'
```
