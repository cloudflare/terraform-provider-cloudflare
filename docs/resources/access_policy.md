---
page_title: "cloudflare_access_policy Resource - Cloudflare"
subcategory: ""
description: |-
  
---

# cloudflare_access_policy (Resource)



~> It's required that an `account_id` or `zone_id` is provided and in most cases using either is fine.
   However, if you're using a scoped access token, you must provide the argument that matches the token's
   scope. For example, an access token that is scoped to the "example.com" zone needs to use the `zone_id` argument.
   If 'application_id' is omitted, the policy created can be reused by multiple access applications.
   Any cloudflare_access_application resource can reference reusable policies through its `policies` argument.
   To destroy a reusable policy and remove it from all applications' policies lists on the same apply, preemptively set the
   lifecycle option `create_before_destroy` to true on the 'cloudflare_access_policy' resource.

## Example Usage

```terraform
# Allowing access to `test@example.com` email address only
resource "cloudflare_access_policy" "test_policy" {
  account_id = "f037e56e89293a057740de681ac9abbe"
  name       = "staging policy"
  precedence = "1"
  decision   = "allow"

  include = [{
    email = ["test@example.com"]
  }]

  require = [{
    email = ["test@example.com"]
  }]
}

# Allowing `test@example.com` to access but only when coming from a
# specific IP.
resource "cloudflare_access_policy" "test_policy" {
  account_id = "f037e56e89293a057740de681ac9abbe"
  name       = "staging policy"
  precedence = "1"
  decision   = "allow"

  include = [{
    email = ["test@example.com"]
  }]

  require = [{
    ip = [var.office_ip]
  }]
}
```
<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `app_id` (String) UUID
- `decision` (String) The action Access will take if a user matches this policy.
- `include` (Attributes List) Rules evaluated with an OR logical operator. A user needs to meet only one of the Include rules. (see [below for nested schema](#nestedatt--include))
- `name` (String) The name of the Access policy.

### Optional

- `account_id` (String) The Account ID to use for this endpoint. Mutually exclusive with the Zone ID.
- `approval_groups` (Attributes List) Administrators who can approve a temporary authentication request. (see [below for nested schema](#nestedatt--approval_groups))
- `approval_required` (Boolean) Requires the user to request access from an administrator at the start of each session.
- `exclude` (Attributes List) Rules evaluated with a NOT logical operator. To match the policy, a user cannot meet any of the Exclude rules. (see [below for nested schema](#nestedatt--exclude))
- `isolation_required` (Boolean) Require this application to be served in an isolated browser for users matching this policy. 'Client Web Isolation' must be on for the account in order to use this feature.
- `precedence` (Number) The order of execution for this policy. Must be unique for each policy within an app.
- `purpose_justification_prompt` (String) A custom message that will appear on the purpose justification screen.
- `purpose_justification_required` (Boolean) Require users to enter a justification when they log in to the application.
- `require` (Attributes List) Rules evaluated with an AND logical operator. To match the policy, a user must meet all of the Require rules. (see [below for nested schema](#nestedatt--require))
- `session_duration` (String) The amount of time that tokens issued for the application will be valid. Must be in the format `300ms` or `2h45m`. Valid time units are: ns, us (or Âµs), ms, s, m, h.
- `zone_id` (String) The Zone ID to use for this endpoint. Mutually exclusive with the Account ID.

### Read-Only

- `created_at` (String)
- `id` (String) The UUID of the policy
- `updated_at` (String)

<a id="nestedatt--include"></a>
### Nested Schema for `include`

Optional:

- `any_valid_service_token` (String) An empty object which matches on all service tokens.
- `auth_method` (Attributes) (see [below for nested schema](#nestedatt--include--auth_method))
- `azure_ad` (Attributes) (see [below for nested schema](#nestedatt--include--azure_ad))
- `certificate` (String)
- `device_posture` (Attributes) (see [below for nested schema](#nestedatt--include--device_posture))
- `email` (Attributes) (see [below for nested schema](#nestedatt--include--email))
- `email_domain` (Attributes) (see [below for nested schema](#nestedatt--include--email_domain))
- `email_list` (Attributes) (see [below for nested schema](#nestedatt--include--email_list))
- `everyone` (String) An empty object which matches on all users.
- `external_evaluation` (Attributes) (see [below for nested schema](#nestedatt--include--external_evaluation))
- `geo` (Attributes) (see [below for nested schema](#nestedatt--include--geo))
- `github_organization` (Attributes) (see [below for nested schema](#nestedatt--include--github_organization))
- `group` (Attributes) (see [below for nested schema](#nestedatt--include--group))
- `gsuite` (Attributes) (see [below for nested schema](#nestedatt--include--gsuite))
- `ip` (Attributes) (see [below for nested schema](#nestedatt--include--ip))
- `ip_list` (Attributes) (see [below for nested schema](#nestedatt--include--ip_list))
- `okta` (Attributes) (see [below for nested schema](#nestedatt--include--okta))
- `saml` (Attributes) (see [below for nested schema](#nestedatt--include--saml))
- `service_token` (Attributes) (see [below for nested schema](#nestedatt--include--service_token))

<a id="nestedatt--include--auth_method"></a>
### Nested Schema for `include.auth_method`

Required:

- `auth_method` (String) The type of authentication method https://datatracker.ietf.org/doc/html/rfc8176.


<a id="nestedatt--include--azure_ad"></a>
### Nested Schema for `include.azure_ad`

Required:

- `connection_id` (String) The ID of your Azure identity provider.
- `id` (String) The ID of an Azure group.


<a id="nestedatt--include--device_posture"></a>
### Nested Schema for `include.device_posture`

Required:

- `integration_uid` (String) The ID of a device posture integration.


<a id="nestedatt--include--email"></a>
### Nested Schema for `include.email`

Required:

- `email` (String) The email of the user.


<a id="nestedatt--include--email_domain"></a>
### Nested Schema for `include.email_domain`

Required:

- `domain` (String) The email domain to match.


<a id="nestedatt--include--email_list"></a>
### Nested Schema for `include.email_list`

Required:

- `id` (String) The ID of a previously created email list.


<a id="nestedatt--include--external_evaluation"></a>
### Nested Schema for `include.external_evaluation`

Required:

- `evaluate_url` (String) The API endpoint containing your business logic.
- `keys_url` (String) The API endpoint containing the key that Access uses to verify that the response came from your API.


<a id="nestedatt--include--geo"></a>
### Nested Schema for `include.geo`

Required:

- `country_code` (String) The country code that should be matched.


<a id="nestedatt--include--github_organization"></a>
### Nested Schema for `include.github_organization`

Required:

- `connection_id` (String) The ID of your Github identity provider.
- `name` (String) The name of the organization.


<a id="nestedatt--include--group"></a>
### Nested Schema for `include.group`

Required:

- `id` (String) The ID of a previously created Access group.


<a id="nestedatt--include--gsuite"></a>
### Nested Schema for `include.gsuite`

Required:

- `connection_id` (String) The ID of your Google Workspace identity provider.
- `email` (String) The email of the Google Workspace group.


<a id="nestedatt--include--ip"></a>
### Nested Schema for `include.ip`

Required:

- `ip` (String) An IPv4 or IPv6 CIDR block.


<a id="nestedatt--include--ip_list"></a>
### Nested Schema for `include.ip_list`

Required:

- `id` (String) The ID of a previously created IP list.


<a id="nestedatt--include--okta"></a>
### Nested Schema for `include.okta`

Required:

- `connection_id` (String) The ID of your Okta identity provider.
- `email` (String) The email of the Okta group.


<a id="nestedatt--include--saml"></a>
### Nested Schema for `include.saml`

Required:

- `attribute_name` (String) The name of the SAML attribute.
- `attribute_value` (String) The SAML attribute value to look for.


<a id="nestedatt--include--service_token"></a>
### Nested Schema for `include.service_token`

Required:

- `token_id` (String) The ID of a Service Token.



<a id="nestedatt--approval_groups"></a>
### Nested Schema for `approval_groups`

Required:

- `approvals_needed` (Number) The number of approvals needed to obtain access.

Optional:

- `email_addresses` (List of String) A list of emails that can approve the access request.
- `email_list_uuid` (String) The UUID of an re-usable email list.


<a id="nestedatt--exclude"></a>
### Nested Schema for `exclude`

Optional:

- `any_valid_service_token` (String) An empty object which matches on all service tokens.
- `auth_method` (Attributes) (see [below for nested schema](#nestedatt--exclude--auth_method))
- `azure_ad` (Attributes) (see [below for nested schema](#nestedatt--exclude--azure_ad))
- `certificate` (String)
- `device_posture` (Attributes) (see [below for nested schema](#nestedatt--exclude--device_posture))
- `email` (Attributes) (see [below for nested schema](#nestedatt--exclude--email))
- `email_domain` (Attributes) (see [below for nested schema](#nestedatt--exclude--email_domain))
- `email_list` (Attributes) (see [below for nested schema](#nestedatt--exclude--email_list))
- `everyone` (String) An empty object which matches on all users.
- `external_evaluation` (Attributes) (see [below for nested schema](#nestedatt--exclude--external_evaluation))
- `geo` (Attributes) (see [below for nested schema](#nestedatt--exclude--geo))
- `github_organization` (Attributes) (see [below for nested schema](#nestedatt--exclude--github_organization))
- `group` (Attributes) (see [below for nested schema](#nestedatt--exclude--group))
- `gsuite` (Attributes) (see [below for nested schema](#nestedatt--exclude--gsuite))
- `ip` (Attributes) (see [below for nested schema](#nestedatt--exclude--ip))
- `ip_list` (Attributes) (see [below for nested schema](#nestedatt--exclude--ip_list))
- `okta` (Attributes) (see [below for nested schema](#nestedatt--exclude--okta))
- `saml` (Attributes) (see [below for nested schema](#nestedatt--exclude--saml))
- `service_token` (Attributes) (see [below for nested schema](#nestedatt--exclude--service_token))

<a id="nestedatt--exclude--auth_method"></a>
### Nested Schema for `exclude.auth_method`

Required:

- `auth_method` (String) The type of authentication method https://datatracker.ietf.org/doc/html/rfc8176.


<a id="nestedatt--exclude--azure_ad"></a>
### Nested Schema for `exclude.azure_ad`

Required:

- `connection_id` (String) The ID of your Azure identity provider.
- `id` (String) The ID of an Azure group.


<a id="nestedatt--exclude--device_posture"></a>
### Nested Schema for `exclude.device_posture`

Required:

- `integration_uid` (String) The ID of a device posture integration.


<a id="nestedatt--exclude--email"></a>
### Nested Schema for `exclude.email`

Required:

- `email` (String) The email of the user.


<a id="nestedatt--exclude--email_domain"></a>
### Nested Schema for `exclude.email_domain`

Required:

- `domain` (String) The email domain to match.


<a id="nestedatt--exclude--email_list"></a>
### Nested Schema for `exclude.email_list`

Required:

- `id` (String) The ID of a previously created email list.


<a id="nestedatt--exclude--external_evaluation"></a>
### Nested Schema for `exclude.external_evaluation`

Required:

- `evaluate_url` (String) The API endpoint containing your business logic.
- `keys_url` (String) The API endpoint containing the key that Access uses to verify that the response came from your API.


<a id="nestedatt--exclude--geo"></a>
### Nested Schema for `exclude.geo`

Required:

- `country_code` (String) The country code that should be matched.


<a id="nestedatt--exclude--github_organization"></a>
### Nested Schema for `exclude.github_organization`

Required:

- `connection_id` (String) The ID of your Github identity provider.
- `name` (String) The name of the organization.


<a id="nestedatt--exclude--group"></a>
### Nested Schema for `exclude.group`

Required:

- `id` (String) The ID of a previously created Access group.


<a id="nestedatt--exclude--gsuite"></a>
### Nested Schema for `exclude.gsuite`

Required:

- `connection_id` (String) The ID of your Google Workspace identity provider.
- `email` (String) The email of the Google Workspace group.


<a id="nestedatt--exclude--ip"></a>
### Nested Schema for `exclude.ip`

Required:

- `ip` (String) An IPv4 or IPv6 CIDR block.


<a id="nestedatt--exclude--ip_list"></a>
### Nested Schema for `exclude.ip_list`

Required:

- `id` (String) The ID of a previously created IP list.


<a id="nestedatt--exclude--okta"></a>
### Nested Schema for `exclude.okta`

Required:

- `connection_id` (String) The ID of your Okta identity provider.
- `email` (String) The email of the Okta group.


<a id="nestedatt--exclude--saml"></a>
### Nested Schema for `exclude.saml`

Required:

- `attribute_name` (String) The name of the SAML attribute.
- `attribute_value` (String) The SAML attribute value to look for.


<a id="nestedatt--exclude--service_token"></a>
### Nested Schema for `exclude.service_token`

Required:

- `token_id` (String) The ID of a Service Token.



<a id="nestedatt--require"></a>
### Nested Schema for `require`

Optional:

- `any_valid_service_token` (String) An empty object which matches on all service tokens.
- `auth_method` (Attributes) (see [below for nested schema](#nestedatt--require--auth_method))
- `azure_ad` (Attributes) (see [below for nested schema](#nestedatt--require--azure_ad))
- `certificate` (String)
- `device_posture` (Attributes) (see [below for nested schema](#nestedatt--require--device_posture))
- `email` (Attributes) (see [below for nested schema](#nestedatt--require--email))
- `email_domain` (Attributes) (see [below for nested schema](#nestedatt--require--email_domain))
- `email_list` (Attributes) (see [below for nested schema](#nestedatt--require--email_list))
- `everyone` (String) An empty object which matches on all users.
- `external_evaluation` (Attributes) (see [below for nested schema](#nestedatt--require--external_evaluation))
- `geo` (Attributes) (see [below for nested schema](#nestedatt--require--geo))
- `github_organization` (Attributes) (see [below for nested schema](#nestedatt--require--github_organization))
- `group` (Attributes) (see [below for nested schema](#nestedatt--require--group))
- `gsuite` (Attributes) (see [below for nested schema](#nestedatt--require--gsuite))
- `ip` (Attributes) (see [below for nested schema](#nestedatt--require--ip))
- `ip_list` (Attributes) (see [below for nested schema](#nestedatt--require--ip_list))
- `okta` (Attributes) (see [below for nested schema](#nestedatt--require--okta))
- `saml` (Attributes) (see [below for nested schema](#nestedatt--require--saml))
- `service_token` (Attributes) (see [below for nested schema](#nestedatt--require--service_token))

<a id="nestedatt--require--auth_method"></a>
### Nested Schema for `require.auth_method`

Required:

- `auth_method` (String) The type of authentication method https://datatracker.ietf.org/doc/html/rfc8176.


<a id="nestedatt--require--azure_ad"></a>
### Nested Schema for `require.azure_ad`

Required:

- `connection_id` (String) The ID of your Azure identity provider.
- `id` (String) The ID of an Azure group.


<a id="nestedatt--require--device_posture"></a>
### Nested Schema for `require.device_posture`

Required:

- `integration_uid` (String) The ID of a device posture integration.


<a id="nestedatt--require--email"></a>
### Nested Schema for `require.email`

Required:

- `email` (String) The email of the user.


<a id="nestedatt--require--email_domain"></a>
### Nested Schema for `require.email_domain`

Required:

- `domain` (String) The email domain to match.


<a id="nestedatt--require--email_list"></a>
### Nested Schema for `require.email_list`

Required:

- `id` (String) The ID of a previously created email list.


<a id="nestedatt--require--external_evaluation"></a>
### Nested Schema for `require.external_evaluation`

Required:

- `evaluate_url` (String) The API endpoint containing your business logic.
- `keys_url` (String) The API endpoint containing the key that Access uses to verify that the response came from your API.


<a id="nestedatt--require--geo"></a>
### Nested Schema for `require.geo`

Required:

- `country_code` (String) The country code that should be matched.


<a id="nestedatt--require--github_organization"></a>
### Nested Schema for `require.github_organization`

Required:

- `connection_id` (String) The ID of your Github identity provider.
- `name` (String) The name of the organization.


<a id="nestedatt--require--group"></a>
### Nested Schema for `require.group`

Required:

- `id` (String) The ID of a previously created Access group.


<a id="nestedatt--require--gsuite"></a>
### Nested Schema for `require.gsuite`

Required:

- `connection_id` (String) The ID of your Google Workspace identity provider.
- `email` (String) The email of the Google Workspace group.


<a id="nestedatt--require--ip"></a>
### Nested Schema for `require.ip`

Required:

- `ip` (String) An IPv4 or IPv6 CIDR block.


<a id="nestedatt--require--ip_list"></a>
### Nested Schema for `require.ip_list`

Required:

- `id` (String) The ID of a previously created IP list.


<a id="nestedatt--require--okta"></a>
### Nested Schema for `require.okta`

Required:

- `connection_id` (String) The ID of your Okta identity provider.
- `email` (String) The email of the Okta group.


<a id="nestedatt--require--saml"></a>
### Nested Schema for `require.saml`

Required:

- `attribute_name` (String) The name of the SAML attribute.
- `attribute_value` (String) The SAML attribute value to look for.


<a id="nestedatt--require--service_token"></a>
### Nested Schema for `require.service_token`

Required:

- `token_id` (String) The ID of a Service Token.

## Import

Import is supported using the following syntax:

```shell
$ terraform import cloudflare_access_policy.example account/<account_id>/<application_id>/<policy_id>
```
