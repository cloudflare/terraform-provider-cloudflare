---
page_title: "cloudflare_access_policy Resource - Cloudflare"
subcategory: ""
description: |-
  Provides a Cloudflare Access Policy resource. Access Policies are
  used in conjunction with Access Applications to restrict access to
  a particular resource.
---

# cloudflare_access_policy (Resource)

Provides a Cloudflare Access Policy resource. Access Policies are
used in conjunction with Access Applications to restrict access to
a particular resource.

~> It's required that an `account_id` or `zone_id` is provided and in most cases using either is fine.
   However, if you're using a scoped access token, you must provide the argument that matches the token's
   scope. For example, an access token that is scoped to the "example.com" zone needs to use the `zone_id` argument.
   If 'application_id' is omitted, the policy created can be reused by multiple access applications.
   Any access_application resource can reference reusable policies through its `policies` argument.
   To destroy a reusable policy and remove it from all applications' policies lists on the same apply, preemptively set the
   lifecycle option `create_before_destroy` to true on the 'access_policy' resource.

## Example Usage

```terraform
# Allowing access to `test@example.com` email address only
resource "cloudflare_access_policy" "test_policy" {
  application_id = "cb029e245cfdd66dc8d2e570d5dd3322"
  zone_id        = "0da42c8d2132a9ddaf714f9e7c920711"
  name           = "staging policy"
  precedence     = "1"
  decision       = "allow"

  include {
    email = ["test@example.com"]
  }

  require {
    email = ["test@example.com"]
  }
}

# Allowing `test@example.com` to access but only when coming from a
# specific IP.
resource "cloudflare_access_policy" "test_policy" {
  application_id = "cb029e245cfdd66dc8d2e570d5dd3322"
  zone_id        = "0da42c8d2132a9ddaf714f9e7c920711"
  name           = "staging policy"
  precedence     = "1"
  decision       = "allow"

  include {
    email = ["test@example.com"]
  }

  require {
    ip = [var.office_ip]
  }
}
```
<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `decision` (String) Defines the action Access will take if the policy matches the user. Available values: `allow`, `deny`, `non_identity`, `bypass`.
- `include` (Block List, Min: 1) A series of access conditions, see [Access Groups](https://registry.terraform.io/providers/cloudflare/cloudflare/latest/docs/resources/access_group#conditions). (see [below for nested schema](#nestedblock--include))
- `name` (String) Friendly name of the Access Policy.

### Optional

- `account_id` (String) The account identifier to target for the resource. Must provide only one of `account_id`, `zone_id`. **Modifying this attribute will force creation of a new resource.**
- `application_id` (String, Deprecated) The ID of the application the policy is associated with. Required when using `precedence`. **Modifying this attribute will force creation of a new resource.**
- `approval_group` (Block List) (see [below for nested schema](#nestedblock--approval_group))
- `approval_required` (Boolean)
- `exclude` (Block List) A series of access conditions, see [Access Groups](https://registry.terraform.io/providers/cloudflare/cloudflare/latest/docs/resources/access_group#conditions). (see [below for nested schema](#nestedblock--exclude))
- `isolation_required` (Boolean) Require this application to be served in an isolated browser for users matching this policy.
- `precedence` (Number, Deprecated) The unique precedence for policies on a single application. Required when using `application_id`.
- `purpose_justification_prompt` (String) The prompt to display to the user for a justification for accessing the resource. Required when using `purpose_justification_required`.
- `purpose_justification_required` (Boolean) Whether to prompt the user for a justification for accessing the resource.
- `require` (Block List) A series of access conditions, see [Access Groups](https://registry.terraform.io/providers/cloudflare/cloudflare/latest/docs/resources/access_group#conditions). (see [below for nested schema](#nestedblock--require))
- `session_duration` (String) How often a user will be forced to re-authorise. Must be in the format `48h` or `2h45m`.
- `zone_id` (String) The zone identifier to target for the resource. **Modifying this attribute will force creation of a new resource.**

### Read-Only

- `id` (String) The ID of this resource.

<a id="nestedblock--include"></a>
### Nested Schema for `include`

Optional:

- `any_valid_service_token` (Boolean)
- `auth_context` (Block List) (see [below for nested schema](#nestedblock--include--auth_context))
- `auth_method` (String)
- `azure` (Block List) (see [below for nested schema](#nestedblock--include--azure))
- `certificate` (Boolean)
- `common_name` (String)
- `common_names` (List of String) Overflow field if you need to have multiple common_name rules in a single policy.  Use in place of the singular common_name field.
- `device_posture` (List of String)
- `email` (List of String)
- `email_domain` (List of String)
- `email_list` (List of String)
- `everyone` (Boolean)
- `external_evaluation` (Block List, Max: 1) (see [below for nested schema](#nestedblock--include--external_evaluation))
- `geo` (List of String)
- `github` (Block List) (see [below for nested schema](#nestedblock--include--github))
- `group` (List of String)
- `gsuite` (Block List) (see [below for nested schema](#nestedblock--include--gsuite))
- `ip` (List of String) An IPv4 or IPv6 CIDR block.
- `ip_list` (List of String) The ID of an existing IP list to reference.
- `login_method` (List of String)
- `okta` (Block List) (see [below for nested schema](#nestedblock--include--okta))
- `saml` (Block List) (see [below for nested schema](#nestedblock--include--saml))
- `service_token` (List of String)

<a id="nestedblock--include--auth_context"></a>
### Nested Schema for `include.auth_context`

Required:

- `ac_id` (String) The ACID of the Authentication Context.
- `id` (String) The ID of the Authentication Context.
- `identity_provider_id` (String) The ID of the Azure Identity provider.


<a id="nestedblock--include--azure"></a>
### Nested Schema for `include.azure`

Optional:

- `id` (List of String) The ID of the Azure group or user.
- `identity_provider_id` (String) The ID of the Azure Identity provider.


<a id="nestedblock--include--external_evaluation"></a>
### Nested Schema for `include.external_evaluation`

Optional:

- `evaluate_url` (String)
- `keys_url` (String)


<a id="nestedblock--include--github"></a>
### Nested Schema for `include.github`

Optional:

- `identity_provider_id` (String)
- `name` (String)
- `teams` (List of String)


<a id="nestedblock--include--gsuite"></a>
### Nested Schema for `include.gsuite`

Optional:

- `email` (List of String)
- `identity_provider_id` (String)


<a id="nestedblock--include--okta"></a>
### Nested Schema for `include.okta`

Optional:

- `identity_provider_id` (String)
- `name` (List of String)


<a id="nestedblock--include--saml"></a>
### Nested Schema for `include.saml`

Optional:

- `attribute_name` (String)
- `attribute_value` (String)
- `identity_provider_id` (String)



<a id="nestedblock--approval_group"></a>
### Nested Schema for `approval_group`

Required:

- `approvals_needed` (Number) Number of approvals needed.

Optional:

- `email_addresses` (List of String) List of emails to request approval from.
- `email_list_uuid` (String)


<a id="nestedblock--exclude"></a>
### Nested Schema for `exclude`

Optional:

- `any_valid_service_token` (Boolean)
- `auth_context` (Block List) (see [below for nested schema](#nestedblock--exclude--auth_context))
- `auth_method` (String)
- `azure` (Block List) (see [below for nested schema](#nestedblock--exclude--azure))
- `certificate` (Boolean)
- `common_name` (String)
- `common_names` (List of String) Overflow field if you need to have multiple common_name rules in a single policy.  Use in place of the singular common_name field.
- `device_posture` (List of String)
- `email` (List of String)
- `email_domain` (List of String)
- `email_list` (List of String)
- `everyone` (Boolean)
- `external_evaluation` (Block List, Max: 1) (see [below for nested schema](#nestedblock--exclude--external_evaluation))
- `geo` (List of String)
- `github` (Block List) (see [below for nested schema](#nestedblock--exclude--github))
- `group` (List of String)
- `gsuite` (Block List) (see [below for nested schema](#nestedblock--exclude--gsuite))
- `ip` (List of String) An IPv4 or IPv6 CIDR block.
- `ip_list` (List of String) The ID of an existing IP list to reference.
- `login_method` (List of String)
- `okta` (Block List) (see [below for nested schema](#nestedblock--exclude--okta))
- `saml` (Block List) (see [below for nested schema](#nestedblock--exclude--saml))
- `service_token` (List of String)

<a id="nestedblock--exclude--auth_context"></a>
### Nested Schema for `exclude.auth_context`

Required:

- `ac_id` (String) The ACID of the Authentication Context.
- `id` (String) The ID of the Authentication Context.
- `identity_provider_id` (String) The ID of the Azure Identity provider.


<a id="nestedblock--exclude--azure"></a>
### Nested Schema for `exclude.azure`

Optional:

- `id` (List of String) The ID of the Azure group or user.
- `identity_provider_id` (String) The ID of the Azure Identity provider.


<a id="nestedblock--exclude--external_evaluation"></a>
### Nested Schema for `exclude.external_evaluation`

Optional:

- `evaluate_url` (String)
- `keys_url` (String)


<a id="nestedblock--exclude--github"></a>
### Nested Schema for `exclude.github`

Optional:

- `identity_provider_id` (String)
- `name` (String)
- `teams` (List of String)


<a id="nestedblock--exclude--gsuite"></a>
### Nested Schema for `exclude.gsuite`

Optional:

- `email` (List of String)
- `identity_provider_id` (String)


<a id="nestedblock--exclude--okta"></a>
### Nested Schema for `exclude.okta`

Optional:

- `identity_provider_id` (String)
- `name` (List of String)


<a id="nestedblock--exclude--saml"></a>
### Nested Schema for `exclude.saml`

Optional:

- `attribute_name` (String)
- `attribute_value` (String)
- `identity_provider_id` (String)



<a id="nestedblock--require"></a>
### Nested Schema for `require`

Optional:

- `any_valid_service_token` (Boolean)
- `auth_context` (Block List) (see [below for nested schema](#nestedblock--require--auth_context))
- `auth_method` (String)
- `azure` (Block List) (see [below for nested schema](#nestedblock--require--azure))
- `certificate` (Boolean)
- `common_name` (String)
- `common_names` (List of String) Overflow field if you need to have multiple common_name rules in a single policy.  Use in place of the singular common_name field.
- `device_posture` (List of String)
- `email` (List of String)
- `email_domain` (List of String)
- `email_list` (List of String)
- `everyone` (Boolean)
- `external_evaluation` (Block List, Max: 1) (see [below for nested schema](#nestedblock--require--external_evaluation))
- `geo` (List of String)
- `github` (Block List) (see [below for nested schema](#nestedblock--require--github))
- `group` (List of String)
- `gsuite` (Block List) (see [below for nested schema](#nestedblock--require--gsuite))
- `ip` (List of String) An IPv4 or IPv6 CIDR block.
- `ip_list` (List of String) The ID of an existing IP list to reference.
- `login_method` (List of String)
- `okta` (Block List) (see [below for nested schema](#nestedblock--require--okta))
- `saml` (Block List) (see [below for nested schema](#nestedblock--require--saml))
- `service_token` (List of String)

<a id="nestedblock--require--auth_context"></a>
### Nested Schema for `require.auth_context`

Required:

- `ac_id` (String) The ACID of the Authentication Context.
- `id` (String) The ID of the Authentication Context.
- `identity_provider_id` (String) The ID of the Azure Identity provider.


<a id="nestedblock--require--azure"></a>
### Nested Schema for `require.azure`

Optional:

- `id` (List of String) The ID of the Azure group or user.
- `identity_provider_id` (String) The ID of the Azure Identity provider.


<a id="nestedblock--require--external_evaluation"></a>
### Nested Schema for `require.external_evaluation`

Optional:

- `evaluate_url` (String)
- `keys_url` (String)


<a id="nestedblock--require--github"></a>
### Nested Schema for `require.github`

Optional:

- `identity_provider_id` (String)
- `name` (String)
- `teams` (List of String)


<a id="nestedblock--require--gsuite"></a>
### Nested Schema for `require.gsuite`

Optional:

- `email` (List of String)
- `identity_provider_id` (String)


<a id="nestedblock--require--okta"></a>
### Nested Schema for `require.okta`

Optional:

- `identity_provider_id` (String)
- `name` (List of String)


<a id="nestedblock--require--saml"></a>
### Nested Schema for `require.saml`

Optional:

- `attribute_name` (String)
- `attribute_value` (String)
- `identity_provider_id` (String)

## Import

Import is supported using the following syntax:

```shell
# Account level import.
$ terraform import cloudflare_access_policy.example account/<account_id>/<application_id>/<policy_id>

# Zone level import.
$ terraform import cloudflare_access_policy.example zone/<zone_id>/<application_id>/<policy_id>
```
