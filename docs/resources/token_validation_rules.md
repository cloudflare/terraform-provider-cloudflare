---
page_title: "cloudflare_token_validation_rules Resource - Cloudflare"
subcategory: ""
description: |-
  
---

# cloudflare_token_validation_rules (Resource)



## Example Usage

```terraform
resource "cloudflare_token_validation_rules" "example_token_validation_rules" {
  zone_id = "023e105f4ecef8ad9ca31a8372d0c353"
  action = "log"
  description = "Long description for Token Validation Rule"
  enabled = true
  expression = "is_jwt_valid(\"52973293-cb04-4a97-8f55-e7d2ad1107dd\") or is_jwt_valid(\"46eab8d1-6376-45e3-968f-2c649d77d423\")"
  selector = {
    exclude = [{
      operation_ids = ["f9c5615e-fe15-48ce-bec6-cfc1946f1bec", "56828eae-035a-4396-ba07-51c66d680a04"]
    }]
    include = [{
      host = ["v1.example.com", "v2.example.com"]
    }]
  }
  title = "Example Token Validation Rule"
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `action` (String) Action to take on requests that match operations included in `selector` and fail `expression`.
Available values: "log", "block".
- `description` (String) A human-readable description that gives more details than `title`.
- `enabled` (Boolean) Toggle rule on or off.
- `expression` (String) Rule expression. Requests that fail to match this expression will be subject to `action`.

For details on expressions, see the [Cloudflare Docs](https://developers.cloudflare.com/api-shield/security/jwt-validation/).
- `selector` (Attributes) Select operations covered by this rule.

For details on selectors, see the [Cloudflare Docs](https://developers.cloudflare.com/api-shield/security/jwt-validation/). (see [below for nested schema](#nestedatt--selector))
- `title` (String) A human-readable name for the rule.
- `zone_id` (String) Identifier.

### Optional

- `position` (Attributes) Update rule order among zone rules. (see [below for nested schema](#nestedatt--position))

### Read-Only

- `created_at` (String)
- `id` (String) UUID.
- `last_updated` (String)

<a id="nestedatt--selector"></a>
### Nested Schema for `selector`

Optional:

- `exclude` (Attributes List) Ignore operations that were otherwise included by `include`. (see [below for nested schema](#nestedatt--selector--exclude))
- `include` (Attributes List) Select all matching operations. (see [below for nested schema](#nestedatt--selector--include))

<a id="nestedatt--selector--exclude"></a>
### Nested Schema for `selector.exclude`

Optional:

- `operation_ids` (List of String) Excluded operation IDs.


<a id="nestedatt--selector--include"></a>
### Nested Schema for `selector.include`

Optional:

- `host` (List of String) Included hostnames.



<a id="nestedatt--position"></a>
### Nested Schema for `position`

Optional:

- `after` (String) Move rule to after rule with this ID.
- `before` (String) Move rule to before rule with this ID.
- `index` (Number) Move rule to this position

## Import

Import is supported using the following syntax:

```shell
$ terraform import cloudflare_token_validation_rules.example '<zone_id>/<rule_id>'
```


