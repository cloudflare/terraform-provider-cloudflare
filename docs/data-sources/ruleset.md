---
page_title: "cloudflare_ruleset Data Source - Cloudflare"
subcategory: ""
description: |-
  
---

# cloudflare_ruleset (Data Source)



## Example Usage

```terraform
data "cloudflare_ruleset" "example_ruleset" {
  zone_id = "9f1839b6152d298aca64c4e906b6d074"
  id      = "2f2feab2026849078ba485f918791bdc"
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Optional

- `account_id` (String) The unique ID of the account.
- `id` (String) The unique ID of the ruleset.
- `ruleset_id` (String, Deprecated) The unique ID of the ruleset.
- `zone_id` (String) The unique ID of the zone.

### Read-Only

- `description` (String) An informative description of the ruleset.
- `kind` (String) The kind of the ruleset.
Available values: "managed", "custom", "root", "zone".
- `last_updated` (String) The timestamp of when the ruleset was last modified.
- `name` (String) The human-readable name of the ruleset.
- `phase` (String) The phase of the ruleset.
Available values: "ddos_l4", "ddos_l7", "http_config_settings", "http_custom_errors", "http_log_custom_fields", "http_ratelimit", "http_request_cache_settings", "http_request_dynamic_redirect", "http_request_firewall_custom", "http_request_firewall_managed", "http_request_late_transform", "http_request_origin", "http_request_redirect", "http_request_sanitize", "http_request_sbfm", "http_request_transform", "http_response_compression", "http_response_firewall_managed", "http_response_headers_transform", "magic_transit", "magic_transit_ids_managed", "magic_transit_managed", "magic_transit_ratelimit".
- `rules` (Attributes List) The list of rules in the ruleset. (see [below for nested schema](#nestedatt--rules))
- `version` (String) The version of the ruleset.

<a id="nestedatt--rules"></a>
### Nested Schema for `rules`

Read-Only:

- `action` (String) The action to perform when the rule matches.
Available values: "block", "challenge", "compress_response", "ddos_dynamic", "execute", "force_connection_close", "js_challenge", "log", "log_custom_field", "managed_challenge", "redirect", "rewrite", "route", "score", "serve_error", "set_cache_settings", "set_config", "skip".
- `action_parameters` (Attributes) The parameters configuring the rule's action. (see [below for nested schema](#nestedatt--rules--action_parameters))
- `description` (String) An informative description of the rule.
- `enabled` (Boolean) Whether the rule should be executed.
- `exposed_credential_check` (Attributes) Configuration for exposed credential checking. (see [below for nested schema](#nestedatt--rules--exposed_credential_check))
- `expression` (String) The expression defining which traffic will match the rule.
- `id` (String) The unique ID of the rule.
- `logging` (Attributes) An object configuring the rule's logging behavior. (see [below for nested schema](#nestedatt--rules--logging))
- `ratelimit` (Attributes) An object configuring the rule's rate limit behavior. (see [below for nested schema](#nestedatt--rules--ratelimit))
- `ref` (String) The reference of the rule (the rule's ID by default).

<a id="nestedatt--rules--action_parameters"></a>
### Nested Schema for `rules.action_parameters`

Read-Only:

- `additional_cacheable_ports` (List of Number) A list of additional ports that caching should be enabled on.
- `algorithms` (Attributes List) Custom order for compression algorithms. (see [below for nested schema](#nestedatt--rules--action_parameters--algorithms))
- `asset_name` (String) The name of a custom asset to serve as the response.
- `automatic_https_rewrites` (Boolean) Whether to enable Automatic HTTPS Rewrites.
- `autominify` (Attributes) Which file extensions to minify automatically. (see [below for nested schema](#nestedatt--rules--action_parameters--autominify))
- `bic` (Boolean) Whether to enable Browser Integrity Check (BIC).
- `browser_ttl` (Attributes) How long client browsers should cache the response. Cloudflare cache purge will not purge content cached on client browsers, so high browser TTLs may lead to stale content. (see [below for nested schema](#nestedatt--rules--action_parameters--browser_ttl))
- `cache` (Boolean) Whether the request's response from the origin is eligible for caching. Caching itself will still depend on the cache control header and your other caching configurations.
- `cache_key` (Attributes) Which components of the request are included in or excluded from the cache key Cloudflare uses to store the response in cache. (see [below for nested schema](#nestedatt--rules--action_parameters--cache_key))
- `cache_reserve` (Attributes) Settings to determine whether the request's response from origin is eligible for Cache Reserve (requires a Cache Reserve add-on plan). (see [below for nested schema](#nestedatt--rules--action_parameters--cache_reserve))
- `content` (String) The response content.
- `content_type` (String) The content type header to set with the error response.
Available values: "application/json", "text/html", "text/plain", "text/xml".
- `cookie_fields` (Attributes List) The cookie fields to log. (see [below for nested schema](#nestedatt--rules--action_parameters--cookie_fields))
- `disable_apps` (Boolean) Whether to disable Cloudflare Apps.
- `disable_rum` (Boolean) Whether to disable Real User Monitoring (RUM).
- `disable_zaraz` (Boolean) Whether to disable Zaraz.
- `edge_ttl` (Attributes) How long the Cloudflare edge network should cache the response. (see [below for nested schema](#nestedatt--rules--action_parameters--edge_ttl))
- `email_obfuscation` (Boolean) Whether to enable Email Obfuscation.
- `fonts` (Boolean) Whether to enable Cloudflare Fonts.
- `from_list` (Attributes) A redirect based on a bulk list lookup. (see [below for nested schema](#nestedatt--rules--action_parameters--from_list))
- `from_value` (Attributes) A redirect based on the request properties. (see [below for nested schema](#nestedatt--rules--action_parameters--from_value))
- `headers` (Attributes Map) A map of headers to rewrite. (see [below for nested schema](#nestedatt--rules--action_parameters--headers))
- `host_header` (String) A value to rewrite the HTTP host header to.
- `hotlink_protection` (Boolean) Whether to enable Hotlink Protection.
- `id` (String) The ID of the ruleset to execute.
- `increment` (Number) A delta to change the score by, which can be either positive or negative.
- `matched_data` (Attributes) The configuration to use for matched data logging. (see [below for nested schema](#nestedatt--rules--action_parameters--matched_data))
- `mirage` (Boolean) Whether to enable Mirage.
- `opportunistic_encryption` (Boolean) Whether to enable Opportunistic Encryption.
- `origin` (Attributes) An origin to route to. (see [below for nested schema](#nestedatt--rules--action_parameters--origin))
- `origin_cache_control` (Boolean) Whether Cloudflare will aim to strictly adhere to RFC 7234.
- `origin_error_page_passthru` (Boolean) Whether to generate Cloudflare error pages for issues from the origin server.
- `overrides` (Attributes) A set of overrides to apply to the target ruleset. (see [below for nested schema](#nestedatt--rules--action_parameters--overrides))
- `phases` (List of String) A list of phases to skip the execution of. This option is incompatible with the rulesets option.
Available values: "ddos_l4", "ddos_l7", "http_config_settings", "http_custom_errors", "http_log_custom_fields", "http_ratelimit", "http_request_cache_settings", "http_request_dynamic_redirect", "http_request_firewall_custom", "http_request_firewall_managed", "http_request_late_transform", "http_request_origin", "http_request_redirect", "http_request_sanitize", "http_request_sbfm", "http_request_transform", "http_response_compression", "http_response_firewall_managed", "http_response_headers_transform", "magic_transit", "magic_transit_ids_managed", "magic_transit_managed", "magic_transit_ratelimit".
- `polish` (String) The Polish level to configure.
Available values: "off", "lossless", "lossy", "webp".
- `products` (List of String) A list of legacy security products to skip the execution of.
Available values: "bic", "hot", "rateLimit", "securityLevel", "uaBlock", "waf", "zoneLockdown".
- `raw_response_fields` (Attributes List) The raw response fields to log. (see [below for nested schema](#nestedatt--rules--action_parameters--raw_response_fields))
- `read_timeout` (Number) A timeout value between two successive read operations to use for your origin server. Historically, the timeout value between two read options from Cloudflare to an origin server is 100 seconds. If you are attempting to reduce HTTP 524 errors because of timeouts from an origin server, try increasing this timeout value.
- `request_fields` (Attributes List) The raw request fields to log. (see [below for nested schema](#nestedatt--rules--action_parameters--request_fields))
- `respect_strong_etags` (Boolean) Whether Cloudflare should respect strong ETag (entity tag) headers. If false, Cloudflare converts strong ETag headers to weak ETag headers.
- `response` (Attributes) The response to show when the block is applied. (see [below for nested schema](#nestedatt--rules--action_parameters--response))
- `response_fields` (Attributes List) The transformed response fields to log. (see [below for nested schema](#nestedatt--rules--action_parameters--response_fields))
- `rocket_loader` (Boolean) Whether to enable Rocket Loader.
- `rules` (Map of List of String) A mapping of ruleset IDs to a list of rule IDs in that ruleset to skip the execution of. This option is incompatible with the ruleset option.
- `ruleset` (String) A ruleset to skip the execution of. This option is incompatible with the rulesets option.
Available values: "current".
- `rulesets` (List of String) A list of ruleset IDs to skip the execution of. This option is incompatible with the ruleset and phases options.
- `security_level` (String) The Security Level to configure.
Available values: "off", "essentially_off", "low", "medium", "high", "under_attack".
- `serve_stale` (Attributes) When to serve stale content from cache. (see [below for nested schema](#nestedatt--rules--action_parameters--serve_stale))
- `server_side_excludes` (Boolean) Whether to enable Server-Side Excludes.
- `sni` (Attributes) A Server Name Indication (SNI) override. (see [below for nested schema](#nestedatt--rules--action_parameters--sni))
- `ssl` (String) The SSL level to configure.
Available values: "off", "flexible", "full", "strict", "origin_pull".
- `status_code` (Number) The status code to use for the error.
- `sxg` (Boolean) Whether to enable Signed Exchanges (SXG).
- `transformed_request_fields` (Attributes List) The transformed request fields to log. (see [below for nested schema](#nestedatt--rules--action_parameters--transformed_request_fields))
- `uri` (Attributes) A URI rewrite. (see [below for nested schema](#nestedatt--rules--action_parameters--uri))

<a id="nestedatt--rules--action_parameters--algorithms"></a>
### Nested Schema for `rules.action_parameters.algorithms`

Read-Only:

- `name` (String) Name of the compression algorithm to enable.
Available values: "none", "auto", "default", "gzip", "brotli", "zstd".


<a id="nestedatt--rules--action_parameters--autominify"></a>
### Nested Schema for `rules.action_parameters.autominify`

Read-Only:

- `css` (Boolean) Whether to minify CSS files.
- `html` (Boolean) Whether to minify HTML files.
- `js` (Boolean) Whether to minify JavaScript files.


<a id="nestedatt--rules--action_parameters--browser_ttl"></a>
### Nested Schema for `rules.action_parameters.browser_ttl`

Read-Only:

- `default` (Number) The browser TTL (in seconds) if you choose the "override_origin" mode.
- `mode` (String) The browser TTL mode.
Available values: "respect_origin", "bypass_by_default", "override_origin", "bypass".


<a id="nestedatt--rules--action_parameters--cache_key"></a>
### Nested Schema for `rules.action_parameters.cache_key`

Read-Only:

- `cache_by_device_type` (Boolean) Whether to separate cached content based on the visitor's device type.
- `cache_deception_armor` (Boolean) Whether to protect from web cache deception attacks, while allowing static assets to be cached.
- `custom_key` (Attributes) Which components of the request are included or excluded from the cache key. (see [below for nested schema](#nestedatt--rules--action_parameters--cache_key--custom_key))
- `ignore_query_strings_order` (Boolean) Whether to treat requests with the same query parameters the same, regardless of the order those query parameters are in.

<a id="nestedatt--rules--action_parameters--cache_key--custom_key"></a>
### Nested Schema for `rules.action_parameters.cache_key.custom_key`

Read-Only:

- `cookie` (Attributes) Which cookies to include in the cache key. (see [below for nested schema](#nestedatt--rules--action_parameters--cache_key--custom_key--cookie))
- `header` (Attributes) Which headers to include in the cache key. (see [below for nested schema](#nestedatt--rules--action_parameters--cache_key--custom_key--header))
- `host` (Attributes) How to use the host in the cache key. (see [below for nested schema](#nestedatt--rules--action_parameters--cache_key--custom_key--host))
- `query_string` (Attributes) Which query string parameters to include in or exclude from the cache key. (see [below for nested schema](#nestedatt--rules--action_parameters--cache_key--custom_key--query_string))
- `user` (Attributes) How to use characteristics of the request user agent in the cache key. (see [below for nested schema](#nestedatt--rules--action_parameters--cache_key--custom_key--user))

<a id="nestedatt--rules--action_parameters--cache_key--custom_key--cookie"></a>
### Nested Schema for `rules.action_parameters.cache_key.custom_key.cookie`

Read-Only:

- `check_presence` (List of String) A list of cookies to check for the presence of. The presence of these cookies is included in the cache key.
- `include` (List of String) A list of cookies to include in the cache key.


<a id="nestedatt--rules--action_parameters--cache_key--custom_key--header"></a>
### Nested Schema for `rules.action_parameters.cache_key.custom_key.header`

Read-Only:

- `check_presence` (List of String) A list of headers to check for the presence of. The presence of these headers is included in the cache key.
- `contains` (Map of List of String) A mapping of header names to a list of values. If a header is present in the request and contains any of the values provided, its value is included in the cache key.
- `exclude_origin` (Boolean) Whether to exclude the origin header in the cache key.
- `include` (List of String) A list of headers to include in the cache key.


<a id="nestedatt--rules--action_parameters--cache_key--custom_key--host"></a>
### Nested Schema for `rules.action_parameters.cache_key.custom_key.host`

Read-Only:

- `resolved` (Boolean) Whether to use the resolved host in the cache key.


<a id="nestedatt--rules--action_parameters--cache_key--custom_key--query_string"></a>
### Nested Schema for `rules.action_parameters.cache_key.custom_key.query_string`

Read-Only:

- `exclude` (Attributes) Which query string parameters to exclude from the cache key. (see [below for nested schema](#nestedatt--rules--action_parameters--cache_key--custom_key--query_string--exclude))
- `include` (Attributes) Which query string parameters to include in the cache key. (see [below for nested schema](#nestedatt--rules--action_parameters--cache_key--custom_key--query_string--include))

<a id="nestedatt--rules--action_parameters--cache_key--custom_key--query_string--exclude"></a>
### Nested Schema for `rules.action_parameters.cache_key.custom_key.query_string.exclude`

Read-Only:

- `all` (Boolean) Whether to exclude all query string parameters from the cache key.
- `list` (List of String) A list of query string parameters to exclude from the cache key.


<a id="nestedatt--rules--action_parameters--cache_key--custom_key--query_string--include"></a>
### Nested Schema for `rules.action_parameters.cache_key.custom_key.query_string.include`

Read-Only:

- `all` (Boolean) Whether to include all query string parameters in the cache key.
- `list` (List of String) A list of query string parameters to include in the cache key.



<a id="nestedatt--rules--action_parameters--cache_key--custom_key--user"></a>
### Nested Schema for `rules.action_parameters.cache_key.custom_key.user`

Read-Only:

- `device_type` (Boolean) Whether to use the user agent's device type in the cache key.
- `geo` (Boolean) Whether to use the user agents's country in the cache key.
- `lang` (Boolean) Whether to use the user agent's language in the cache key.




<a id="nestedatt--rules--action_parameters--cache_reserve"></a>
### Nested Schema for `rules.action_parameters.cache_reserve`

Read-Only:

- `eligible` (Boolean) Whether Cache Reserve is enabled. If this is true and a request meets eligibility criteria, Cloudflare will write the resource to Cache Reserve.
- `minimum_file_size` (Number) The minimum file size eligible for storage in Cache Reserve.


<a id="nestedatt--rules--action_parameters--cookie_fields"></a>
### Nested Schema for `rules.action_parameters.cookie_fields`

Read-Only:

- `name` (String) The name of the cookie.


<a id="nestedatt--rules--action_parameters--edge_ttl"></a>
### Nested Schema for `rules.action_parameters.edge_ttl`

Read-Only:

- `default` (Number) The edge TTL (in seconds) if you choose the "override_origin" mode.
- `mode` (String) The edge TTL mode.
Available values: "respect_origin", "bypass_by_default", "override_origin".
- `status_code_ttl` (Attributes List) A list of TTLs to apply to specific status codes or status code ranges. (see [below for nested schema](#nestedatt--rules--action_parameters--edge_ttl--status_code_ttl))

<a id="nestedatt--rules--action_parameters--edge_ttl--status_code_ttl"></a>
### Nested Schema for `rules.action_parameters.edge_ttl.status_code_ttl`

Read-Only:

- `status_code` (Number) A single status code to apply the TTL to.
- `status_code_range` (Attributes) A range of status codes to apply the TTL to. (see [below for nested schema](#nestedatt--rules--action_parameters--edge_ttl--status_code_ttl--status_code_range))
- `value` (Number) The time to cache the response for (in seconds). A value of 0 is equivalent to setting the cache control header with the value "no-cache". A value of -1 is equivalent to setting the cache control header with the value of "no-store".

<a id="nestedatt--rules--action_parameters--edge_ttl--status_code_ttl--status_code_range"></a>
### Nested Schema for `rules.action_parameters.edge_ttl.status_code_ttl.status_code_range`

Read-Only:

- `from` (Number) The lower bound of the range.
- `to` (Number) The upper bound of the range.




<a id="nestedatt--rules--action_parameters--from_list"></a>
### Nested Schema for `rules.action_parameters.from_list`

Read-Only:

- `key` (String) An expression that evaluates to the list lookup key.
- `name` (String) The name of the list to match against.


<a id="nestedatt--rules--action_parameters--from_value"></a>
### Nested Schema for `rules.action_parameters.from_value`

Read-Only:

- `preserve_query_string` (Boolean) Whether to keep the query string of the original request.
- `status_code` (Number) The status code to use for the redirect.
- `target_url` (Attributes) A URL to redirect the request to. (see [below for nested schema](#nestedatt--rules--action_parameters--from_value--target_url))

<a id="nestedatt--rules--action_parameters--from_value--target_url"></a>
### Nested Schema for `rules.action_parameters.from_value.target_url`

Read-Only:

- `expression` (String) An expression that evaluates to a URL to redirect the request to.
- `value` (String) A URL to redirect the request to.



<a id="nestedatt--rules--action_parameters--headers"></a>
### Nested Schema for `rules.action_parameters.headers`

Read-Only:

- `expression` (String) An expression that evaluates to a value for the header.
- `operation` (String) The operation to perform on the header.
Available values: "add", "set", "remove".
- `value` (String) A static value for the header.


<a id="nestedatt--rules--action_parameters--matched_data"></a>
### Nested Schema for `rules.action_parameters.matched_data`

Read-Only:

- `public_key` (String) The public key to encrypt matched data logs with.


<a id="nestedatt--rules--action_parameters--origin"></a>
### Nested Schema for `rules.action_parameters.origin`

Read-Only:

- `host` (String) A resolved host to route to.
- `port` (Number) A destination port to route to.


<a id="nestedatt--rules--action_parameters--overrides"></a>
### Nested Schema for `rules.action_parameters.overrides`

Read-Only:

- `action` (String) An action to override all rules with. This option has lower precedence than rule and category overrides.
- `categories` (Attributes List) A list of category-level overrides. This option has the second-highest precedence after rule-level overrides. (see [below for nested schema](#nestedatt--rules--action_parameters--overrides--categories))
- `enabled` (Boolean) Whether to enable execution of all rules. This option has lower precedence than rule and category overrides.
- `rules` (Attributes List) A list of rule-level overrides. This option has the highest precedence. (see [below for nested schema](#nestedatt--rules--action_parameters--overrides--rules))
- `sensitivity_level` (String) A sensitivity level to set for all rules. This option has lower precedence than rule and category overrides and is only applicable for DDoS phases.
Available values: "default", "medium", "low", "eoff".

<a id="nestedatt--rules--action_parameters--overrides--categories"></a>
### Nested Schema for `rules.action_parameters.overrides.categories`

Read-Only:

- `action` (String) The action to override rules in the category with.
- `category` (String) The name of the category to override.
- `enabled` (Boolean) Whether to enable execution of rules in the category.
- `sensitivity_level` (String) The sensitivity level to use for rules in the category. This option is only applicable for DDoS phases.
Available values: "default", "medium", "low", "eoff".


<a id="nestedatt--rules--action_parameters--overrides--rules"></a>
### Nested Schema for `rules.action_parameters.overrides.rules`

Read-Only:

- `action` (String) The action to override the rule with.
- `enabled` (Boolean) Whether to enable execution of the rule.
- `id` (String) The ID of the rule to override.
- `score_threshold` (Number) The score threshold to use for the rule.
- `sensitivity_level` (String) The sensitivity level to use for the rule. This option is only applicable for DDoS phases.
Available values: "default", "medium", "low", "eoff".



<a id="nestedatt--rules--action_parameters--raw_response_fields"></a>
### Nested Schema for `rules.action_parameters.raw_response_fields`

Read-Only:

- `name` (String) The name of the response header.
- `preserve_duplicates` (Boolean) Whether to log duplicate values of the same header.


<a id="nestedatt--rules--action_parameters--request_fields"></a>
### Nested Schema for `rules.action_parameters.request_fields`

Read-Only:

- `name` (String) The name of the header.


<a id="nestedatt--rules--action_parameters--response"></a>
### Nested Schema for `rules.action_parameters.response`

Read-Only:

- `content` (String) The content to return.
- `content_type` (String) The type of the content to return.
- `status_code` (Number) The status code to return.


<a id="nestedatt--rules--action_parameters--response_fields"></a>
### Nested Schema for `rules.action_parameters.response_fields`

Read-Only:

- `name` (String) The name of the response header.
- `preserve_duplicates` (Boolean) Whether to log duplicate values of the same header.


<a id="nestedatt--rules--action_parameters--serve_stale"></a>
### Nested Schema for `rules.action_parameters.serve_stale`

Read-Only:

- `disable_stale_while_updating` (Boolean) Whether Cloudflare should disable serving stale content while getting the latest content from the origin.


<a id="nestedatt--rules--action_parameters--sni"></a>
### Nested Schema for `rules.action_parameters.sni`

Read-Only:

- `value` (String) A value to override the SNI to.


<a id="nestedatt--rules--action_parameters--transformed_request_fields"></a>
### Nested Schema for `rules.action_parameters.transformed_request_fields`

Read-Only:

- `name` (String) The name of the header.


<a id="nestedatt--rules--action_parameters--uri"></a>
### Nested Schema for `rules.action_parameters.uri`

Read-Only:

- `path` (Attributes) A URI path rewrite. (see [below for nested schema](#nestedatt--rules--action_parameters--uri--path))
- `query` (Attributes) A URI query rewrite. (see [below for nested schema](#nestedatt--rules--action_parameters--uri--query))

<a id="nestedatt--rules--action_parameters--uri--path"></a>
### Nested Schema for `rules.action_parameters.uri.path`

Read-Only:

- `expression` (String) An expression that evaluates to a value to rewrite the URI path to.
- `value` (String) A value to rewrite the URI path to.


<a id="nestedatt--rules--action_parameters--uri--query"></a>
### Nested Schema for `rules.action_parameters.uri.query`

Read-Only:

- `expression` (String) An expression that evaluates to a value to rewrite the URI query to.
- `value` (String) A value to rewrite the URI query to.




<a id="nestedatt--rules--exposed_credential_check"></a>
### Nested Schema for `rules.exposed_credential_check`

Read-Only:

- `password_expression` (String) An expression that selects the password used in the credentials check.
- `username_expression` (String) An expression that selects the user ID used in the credentials check.


<a id="nestedatt--rules--logging"></a>
### Nested Schema for `rules.logging`

Read-Only:

- `enabled` (Boolean) Whether to generate a log when the rule matches.


<a id="nestedatt--rules--ratelimit"></a>
### Nested Schema for `rules.ratelimit`

Read-Only:

- `characteristics` (List of String) Characteristics of the request on which the rate limit counter will be incremented.
- `counting_expression` (String) An expression that defines when the rate limit counter should be incremented. It defaults to the same as the rule's expression.
- `mitigation_timeout` (Number) Period of time in seconds after which the action will be disabled following its first execution.
- `period` (Number) Period in seconds over which the counter is being incremented.
- `requests_per_period` (Number) The threshold of requests per period after which the action will be executed for the first time.
- `requests_to_origin` (Boolean) Whether counting is only performed when an origin is reached.
- `score_per_period` (Number) The score threshold per period for which the action will be executed the first time.
- `score_response_header_name` (String) A response header name provided by the origin, which contains the score to increment rate limit counter with.


